class ChangeStatusToIntegerInFretes < ActiveRecord::Migration[7.1]
  def up
    # ðŸ”¹ Se jÃ¡ existirem status como texto (ex: "pendente", "em_andamento", "concluido")
    # vocÃª pode mapear aqui para nÃºmeros:
    execute <<-SQL
      UPDATE fretes SET status = '0' WHERE status = 'pendente';
      UPDATE fretes SET status = '1' WHERE status = 'em_andamento';
      UPDATE fretes SET status = '2' WHERE status = 'concluido';
    SQL

    # ðŸ”¹ Agora altera a coluna para integer de forma segura
    change_column :fretes, :status, 'integer USING CAST(status AS integer)', default: 0
  end

  def down
    # Reverte para string se precisar rollback
    change_column :fretes, :status, :string
  end
end

