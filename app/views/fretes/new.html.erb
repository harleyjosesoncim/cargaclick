<%# app/views/fretes/new.html.erb %>
<% content_for :title, "Simular Frete" %>

<!-- ==================================================
     BREADCRUMB
================================================== -->
<nav class="text-sm text-gray-500 mb-4">
  <ol class="flex flex-wrap items-center gap-2">
    <li>
      <%= link_to "InÃ­cio", root_path, class: "hover:text-blue-600 transition" %>
    </li>
    <li>/</li>
    <li class="font-semibold text-gray-700">
      Simular Frete
    </li>
  </ol>
</nav>

<!-- ==================================================
     CABEÃ‡ALHO
================================================== -->
<header class="mb-6">
  <h1 class="text-3xl font-extrabold text-gray-900">
    ğŸš› Simule seu frete em segundos
  </h1>
  <p class="mt-2 text-gray-600 max-w-2xl">
    Compare valores, distÃ¢ncia e condiÃ§Ãµes.
    SimulaÃ§Ã£o gratuita. Login apenas para contratar.
  </p>
</header>

<!-- ==================================================
     CARD â€” SIMULAÃ‡ÃƒO
================================================== -->
<section class="bg-white shadow-xl rounded-3xl p-8 mb-8">
  <h2 class="text-xl font-semibold text-gray-800 mb-6">
    ğŸ” Dados para simulaÃ§Ã£o
  </h2>

  <%= form_with url: simular_frete_post_path, method: :post, local: true do %>

    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">

      <%= text_field_tag :origem, params[:origem],
            placeholder: "Origem (CEP ou endereÃ§o)",
            required: true,
            class: "w-full rounded-xl border-gray-300 px-4 py-3
                    focus:ring-2 focus:ring-blue-500 focus:border-blue-500" %>

      <%= text_field_tag :destino, params[:destino],
            placeholder: "Destino (CEP ou endereÃ§o)",
            required: true,
            class: "w-full rounded-xl border-gray-300 px-4 py-3
                    focus:ring-2 focus:ring-blue-500 focus:border-blue-500" %>

      <%= number_field_tag :peso, params[:peso],
            placeholder: "Peso (kg)",
            min: 0,
            step: 0.1,
            inputmode: "decimal",
            class: "w-full rounded-xl border-gray-300 px-4 py-3
                    focus:ring-2 focus:ring-blue-500 focus:border-blue-500" %>

      <%= number_field_tag :volume, params[:volume],
            placeholder: "Volume (mÂ³)",
            min: 0,
            step: 0.01,
            inputmode: "decimal",
            class: "w-full rounded-xl border-gray-300 px-4 py-3
                    focus:ring-2 focus:ring-blue-500 focus:border-blue-500" %>
    </div>

    <div class="mt-8">
      <%= submit_tag "Calcular Frete",
            class: "w-full bg-gradient-to-r from-blue-600 to-indigo-600
                    hover:opacity-90 text-white font-bold py-4
                    rounded-xl transition shadow-lg" %>
    </div>

  <% end %>
</section>

<!-- ==================================================
     CARD â€” CONTRATAÃ‡ÃƒO / PERFIS
================================================== -->
<section class="bg-gray-50 border border-dashed border-gray-300 rounded-2xl p-6">
  <h2 class="text-lg font-semibold text-gray-700 mb-2">
    ğŸ§¾ ContrataÃ§Ã£o e acesso
  </h2>

  <p class="text-sm text-gray-600 max-w-2xl">
    ApÃ³s a simulaÃ§Ã£o, o acesso muda conforme seu perfil.
  </p>

  <ul class="mt-3 text-sm text-gray-600 space-y-1">
    <li>â€¢ Clientes contratam com pagamento seguro</li>
    <li>â€¢ Transportadores recebem oportunidades no painel</li>
    <li>â€¢ ComissÃ£o da plataforma sempre transparente</li>
  </ul>

  <!-- CTA DINÃ‚MICO (DEFENSIVO) -->
  <div class="mt-6 flex flex-wrap gap-4">

    <% if defined?(cliente_signed_in?) && cliente_signed_in? %>
      <span class="inline-block bg-green-600 text-white
                   font-bold px-6 py-3 rounded-xl shadow">
        âœ… VocÃª pode contratar este frete
      </span>

    <% elsif defined?(transportador_signed_in?) && transportador_signed_in? &&
            respond_to?(:transportadores_dashboard_path) %>
      <%= link_to "Acessar painel de oportunidades",
                  transportadores_dashboard_path,
                  class: "inline-block bg-indigo-600 hover:bg-indigo-700
                          text-white font-bold px-6 py-3 rounded-xl
                          transition shadow" %>

    <% else %>
      <% if respond_to?(:new_cliente_session_path) %>
        <%= link_to "Entrar ou Criar Conta para Contratar",
                    new_cliente_session_path,
                    class: "inline-block bg-green-600 hover:bg-green-700
                            text-white font-semibold px-6 py-3 rounded-xl
                            transition shadow" %>
      <% end %>

      <% if respond_to?(:new_transportador_session_path) %>
        <%= link_to "Sou transportador",
                    new_transportador_session_path,
                    class: "inline-block border border-indigo-600 text-indigo-600
                            hover:bg-indigo-600 hover:text-white
                            font-semibold px-6 py-3 rounded-xl
                            transition shadow" %>
      <% end %>
    <% end %>

  </div>
</section>
