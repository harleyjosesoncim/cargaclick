<%# app/views/fretes/resultado.html.erb %>
<% content_for :title, "Resultado da Simula√ß√£o" %>

<!-- ==================================================
     BREADCRUMB
================================================== -->
<nav class="text-sm text-gray-500 mb-6">
  <ol class="flex flex-wrap items-center gap-2">
    <li>
      <%= link_to "In√≠cio", root_path, class: "hover:text-blue-600 transition" %>
    </li>
    <li>/</li>
    <li>
      <%= link_to "Simular Frete", simular_frete_path, class: "hover:text-blue-600 transition" %>
    </li>
    <li>/</li>
    <li class="font-semibold text-gray-700">
      Resultado
    </li>
  </ol>
</nav>

<!-- ==================================================
     CABE√áALHO
================================================== -->
<header class="mb-8">
  <h1 class="text-3xl font-extrabold text-gray-900">
    üì¶ Resultado da simula√ß√£o
  </h1>
  <p class="mt-2 text-gray-600 max-w-2xl">
    Valores estimados com base nas informa√ß√µes informadas.
    A contrata√ß√£o s√≥ ocorre ap√≥s confirma√ß√£o.
  </p>
</header>

<!-- ==================================================
     CARD PRINCIPAL ‚Äî RESULTADO
================================================== -->
<div class="bg-white shadow-xl rounded-3xl p-8 mb-8">

  <h2 class="text-xl font-semibold text-gray-800 mb-6">
    üí∞ Detalhes do frete
  </h2>

  <dl class="grid grid-cols-1 md:grid-cols-2 gap-6 text-sm">

    <div>
      <dt class="text-gray-500">Origem</dt>
      <dd class="font-semibold text-gray-800">
        <%= @resultado[:origem] %>
      </dd>
    </div>

    <div>
      <dt class="text-gray-500">Destino</dt>
      <dd class="font-semibold text-gray-800">
        <%= @resultado[:destino] %>
      </dd>
    </div>

    <div>
      <dt class="text-gray-500">Dist√¢ncia estimada</dt>
      <dd class="font-semibold text-gray-800">
        <%= @resultado[:distancia_km] %> km
      </dd>
    </div>

    <div>
      <dt class="text-gray-500">Tempo estimado</dt>
      <dd class="font-semibold text-gray-800">
        <%= @resultado[:tempo_estimado] %>
      </dd>
    </div>

    <div>
      <dt class="text-gray-500">Tipo de ve√≠culo</dt>
      <dd class="font-semibold text-gray-800">
        <%= @resultado[:tipo_veiculo] %>
      </dd>
    </div>

    <div>
      <dt class="text-gray-500">Tipo de carga</dt>
      <dd class="font-semibold text-gray-800">
        <%= @resultado[:tipo_carga] %>
      </dd>
    </div>

  </dl>

  <!-- ==================================================
       VALOR DESTACADO
  ================================================== -->
  <div class="mt-8 p-6 rounded-2xl bg-green-50 border border-green-200 text-center">
    <p class="text-sm text-green-700 mb-1">
      Valor estimado do frete
    </p>
    <p class="text-3xl font-extrabold text-green-800">
      R$ <%= number_to_currency(@resultado[:valor_total], unit: "", separator: ",", delimiter: ".") %>
    </p>
    <p class="text-xs text-green-700 mt-2">
      Valor final pode variar conforme confirma√ß√£o do transportador
    </p>
  </div>

</div>

<!-- ==================================================
     CARD ‚Äî A√á√ïES / CONTRATA√á√ÉO
================================================== -->
<div class="bg-gray-50 border border-dashed border-gray-300 rounded-2xl p-6">

  <h2 class="text-lg font-semibold text-gray-700 mb-2">
    üöö Pr√≥ximo passo
  </h2>

  <p class="text-sm text-gray-600 max-w-2xl mb-4">
    Para contratar este frete, √© necess√°rio estar logado como cliente.
  </p>

  <div class="flex flex-wrap gap-4">

    <% if defined?(cliente_signed_in?) && cliente_signed_in? %>
      <!-- CLIENTE LOGADO -->
      <%= button_to "Contratar este frete",
        fretes_path,
        method: :post,
        params: {
          frete: {
            origem:        @resultado[:origem],
            destino:       @resultado[:destino],
            peso:          @resultado[:peso],
            volume:        @resultado[:volume],
            tipo_carga:    @resultado[:tipo_carga],
            tipo_veiculo:  @resultado[:tipo_veiculo],
            valor:         @resultado[:valor_total]
          }
        },
        class: "bg-blue-600 hover:bg-blue-700 text-white
                font-bold px-8 py-4 rounded-xl transition shadow-lg" %>

    <% else %>
      <!-- N√ÉO LOGADO -->
      <%= link_to "Entrar para contratar",
        new_cliente_session_path,
        class: "bg-green-600 hover:bg-green-700 text-white
                font-semibold px-8 py-4 rounded-xl transition shadow-lg" %>

      <%= link_to "Refazer simula√ß√£o",
        simular_frete_path,
        class: "bg-gray-200 hover:bg-gray-300 text-gray-700
                font-semibold px-8 py-4 rounded-xl transition" %>
    <% end %>

  </div>
</div>
