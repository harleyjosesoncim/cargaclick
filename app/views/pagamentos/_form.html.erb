<%# app/views/pagamentos/_form.html.erb %>
<%# Este parcial recebe: frete (objeto), cliente, transportador %>

<% if frete.present? && frete.transportador.present? %>
  <div class="mt-6 bg-white dark:bg-gray-800 rounded-lg shadow p-4 space-y-3">
    <h3 class="text-lg font-semibold text-gray-800 dark:text-gray-200">
      💳 Pagamento via PIX / Mercado Pago
    </h3>

    <p class="text-sm text-gray-600 dark:text-gray-400">
      Frete <strong>##<%= frete.id %></strong> —
      Cliente: <%= cliente&.nome || "N/A" %> —
      Transportador: <%= transportador&.nome || "N/A" %>
    </p>

    <p class="text-base font-bold text-gray-900 dark:text-white">
      Valor a pagar:
      <%= number_to_currency(frete.valor_total) %>
    </p>

    <div class="flex items-center gap-4 mt-4">
      <%= button_to "💳 Pagar agora",
          checkout_pagamentos_path(frete_id: frete.id),
          method: :post,
          class: "bg-indigo-600 hover:bg-indigo-700 text-white px-4 py-2 rounded-lg shadow" %>

      <% if frete.pagamentos.any? %>
        <% pagamento = frete.pagamentos.last %>
        <span class="px-3 py-2 rounded-lg text-sm
                     <%= pagamento.confirmado? ? 'bg-green-100 text-green-700' : 'bg-yellow-100 text-yellow-700' %>">
          💸 Pagamento: <%= pagamento.status.humanize %>
        </span>
      <% else %>
        <span class="text-sm text-gray-500">Nenhum pagamento registrado ainda.</span>
      <% end %>
    </div>
  </div>
<% else %>
  <div class="mt-6 bg-yellow-50 border border-yellow-300 text-yellow-800 rounded-lg p-3">
    ⚠️ Defina um transportador antes de habilitar o pagamento.
  </div>
<% end %>
