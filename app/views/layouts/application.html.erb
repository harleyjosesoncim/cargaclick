<!DOCTYPE html>
<html lang="pt-BR">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- Tema p/ light/dark (ajusta barra do navegador em mobile) -->
    <meta name="theme-color" content="#0b132b" media="(prefers-color-scheme: dark)">
    <meta name="theme-color" content="#ffffff" media="(prefers-color-scheme: light)">

    <!-- SEO & Social -->
    <%= render_meta_tags(
          title:       content_for?(:title)       ? yield(:title)       : "CargaClick ðŸšš",
          description: content_for?(:description) ? yield(:description) : "Conectando clientes e transportadores de forma simples e eficiente.",
          image:       asset_url("cargaclick_og.png"),
          url:         request.original_url
        ) %>
    <link rel="canonical" href="<%= request.original_url %>">

    <!-- SeguranÃ§a -->
    <%= csrf_meta_tags %>
    <%= csp_meta_tag %>

    <!-- Leaflet: Ã­cones fingerprintados (devem existir em app/assets/images) -->
    <meta name="leaflet-icon" content="<%= asset_path('marker-icon.png') %>">
    <meta name="leaflet-icon-2x" content="<%= asset_path('marker-icon-2x.png') %>">
    <meta name="leaflet-shadow" content="<%= asset_path('marker-shadow.png') %>">

    <!-- Stylesheets (ordem importa: libs antes do app) -->
    <%= stylesheet_link_tag "leaflet", "data-turbo-track": "reload" %>
    <%= stylesheet_link_tag "application", "data-turbo-track": "reload" %>

    <!-- JavaScript (bundle gerado pelo esbuild em app/assets/builds) -->
    <%= javascript_include_tag "application", "data-turbo-track": "reload", defer: true %>

    <!-- Alpine.js (CDN) â€” se usar CSP restrito, liberar domÃ­nio no secure_headers -->
    <script defer src="https://unpkg.com/alpinejs@3.x.x/dist/cdn.min.js"></script>

    <!-- Ponto de extensÃ£o para pÃ¡ginas -->
    <%= yield :head %>
  </head>

  <body class="bg-gray-100 dark:bg-gray-900 min-h-screen font-sans antialiased flex flex-col">
    <!-- Navbar global -->
    <header>
      <%= render "layouts/navbar" %>
    </header>

    <!-- Flash messages -->
    <% if lookup_context.exists?("shared/flash") %>
      <section class="container mx-auto mt-4 px-4">
        <%= render "shared/flash" %>
      </section>
    <% end %>

    <!-- ConteÃºdo principal -->
    <main class="container mx-auto flex-1 px-4 pt-24 pb-8">
      <%= yield %>
    </main>

    <!-- RodapÃ© -->
    <footer>
      <%= render "layouts/footer" %>
    </footer>

    <!-- Ponto de extensÃ£o para scripts no fim do body -->
    <%= yield :body_end %>
  </body>
</html>
