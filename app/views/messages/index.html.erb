<% content_for :title, "Chat — Frete ##{@frete.id}" %>

<div class="flex flex-col h-[80vh] max-h-[80vh] bg-white dark:bg-gray-900 shadow-md rounded-lg overflow-hidden">
  <!-- Header -->
  <div class="px-4 py-3 bg-gradient-to-r from-blue-600 to-blue-800 text-white font-semibold flex items-center justify-between">
    <span>💬 Chat — Frete ##{@frete.id}</span>
    <%= link_to "⬅ Voltar", fretes_path, class: "text-sm hover:underline" %>
  </div>

  <!-- Área de mensagens -->
  <div id="messages"
       class="flex-1 overflow-y-auto p-4 space-y-3 bg-gray-50 dark:bg-gray-800">
    <%= turbo_stream_from "frete_#{@frete.id}_messages" %>
    <%= render @messages %>
  </div>

  <!-- Formulário fixo no rodapé -->
  <div class="border-t dark:border-gray-700 bg-white dark:bg-gray-900 px-4 py-3">
    <%= turbo_frame_tag "new_message" do %>
      <%= form_with(model: [@frete, @message],
                    data: { turbo_frame: "messages" },
                    class: "flex gap-2") do |f| %>
        <%= f.text_field :content,
              placeholder: "Digite sua mensagem...",
              class: "flex-1 rounded-lg border-gray-300 dark:border-gray-700 dark:bg-gray-800 dark:text-white focus:ring-blue-500 focus:border-blue-500" %>
        <%= f.submit "Enviar",
              class: "px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition" %>
      <% end %>
    <% end %>
  </div>
</div>

