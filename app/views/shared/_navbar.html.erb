<%# Navbar mobile-first, segura, sem rotas quebradas e alinhada aos escopos %>

<% inicio_path  = nav_path(:root_path, :home_path, fallback: "/") %>
<% sim_path     = nav_path(:new_frete_path, :new_calculo_path, :new_simulacao_path, fallback: inicio_path) %>
<% contato_path = nav_path(:new_contato_path, :contato_path, fallback: inicio_path) %>

<nav class="bg-gradient-to-r from-purple-900 to-purple-700 shadow-lg fixed top-0 left-0 w-full z-50">
  <div class="max-w-7xl mx-auto px-4">
    <div class="h-16 flex items-center justify-between">

      <!-- BotÃ£o menu (mobile) -->
      <div class="md:hidden">
        <button id="cc-mobile-menu-btn"
                type="button"
                class="inline-flex items-center justify-center rounded-lg p-2 text-white hover:bg-white/10 focus:outline-none focus:ring-2 focus:ring-white/30"
                aria-controls="cc-mobile-menu"
                aria-expanded="false">
          <span class="sr-only">Abrir menu</span>
          <svg class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                  d="M4 6h16M4 12h16M4 18h16" />
          </svg>
        </button>
      </div>

      <!-- Logo -->
      <div class="flex-1 flex justify-center md:justify-start">
        <%= link_to inicio_path,
              class: "flex items-center gap-2 text-white text-xl font-extrabold tracking-wide hover:text-purple-200 transition" do %>
          <span class="text-2xl">ðŸš›</span>
          <span>CargaClick</span>
        <% end %>
      </div>

      <div class="md:hidden w-10"></div>

      <!-- Links desktop -->
      <div class="hidden md:flex items-center gap-2 text-sm">

        <%= link_to "InÃ­cio", inicio_path,
              class: "px-3 py-2 rounded-lg font-semibold text-white hover:bg-white/10 #{nav_active_class(inicio_path)}" %>

        <%= link_to "Simular frete", sim_path,
              class: "px-3 py-2 rounded-lg font-semibold text-white hover:bg-white/10 #{nav_active_class(sim_path)}" %>

        <% if route_exists?(:fidelidade_path) %>
          <%= link_to "Fidelidade", fidelidade_path,
                class: "px-3 py-2 rounded-lg font-semibold text-white hover:bg-white/10 #{nav_active_class(fidelidade_path)}" %>
        <% end %>

        <% if route_exists?(:about_path) %>
          <%= link_to "Sobre", about_path,
                class: "px-3 py-2 rounded-lg font-semibold text-white hover:bg-white/10 #{nav_active_class(about_path)}" %>
        <% end %>

        <%= link_to "Contato", contato_path,
              class: "px-3 py-2 rounded-lg font-semibold text-white hover:bg-white/10 #{nav_active_class(contato_path)}" %>

        <!-- Ãrea autenticada -->
        <% if cliente_signed_in? %>
          <%= link_to "Minha Ã¡rea", clientes_root_path,
                class: "ml-2 px-3 py-2 rounded-lg font-bold bg-white/15 text-white hover:bg-white/25 transition" %>

          <%= link_to "Sair", destroy_cliente_session_path, method: :delete,
                class: "px-3 py-2 rounded-lg font-semibold text-white hover:bg-white/10" %>

        <% elsif transportador_signed_in? %>
          <%= link_to "Minha Ã¡rea", transportadores_root_path,
                class: "ml-2 px-3 py-2 rounded-lg font-bold bg-yellow-400/90 text-black hover:bg-yellow-300 transition" %>

          <%= link_to "Sair", destroy_transportador_session_path, method: :delete,
                class: "px-3 py-2 rounded-lg font-semibold text-white hover:bg-white/10" %>

        <% else %>
          <%= link_to "Criar conta", new_cliente_registration_path,
                class: "ml-2 px-4 py-2 rounded-xl font-bold bg-white text-purple-800 hover:bg-purple-100 transition" %>

          <%= link_to "Entrar", new_cliente_session_path,
                class: "px-3 py-2 rounded-lg font-semibold text-white hover:bg-white/10" %>
        <% end %>

        <% if defined?(admin_signed_in?) && admin_signed_in? %>
          <%= link_to "Admin", admin_root_path,
                class: "ml-2 px-3 py-2 rounded-lg font-semibold text-white hover:bg-white/10" %>
        <% end %>
      </div>
    </div>

    <!-- Menu mobile -->
    <div id="cc-mobile-menu" class="md:hidden hidden pb-3">
      <div class="mt-2 rounded-xl bg-white/10 backdrop-blur p-2">

        <%= link_to "InÃ­cio", inicio_path, class: "block nav-mobile" %>
